import{_ as C,p as S,s as T,o as i,b as x,c as d,j as a,ak as V,al as E,J as g,a2 as I,e as N,am as M,y as n,h as A,C as B,an as H,G as D,H as w,a as k,t as _,k as P}from"./chunks/framework.DVuO40We.js";import{g as R}from"./chunks/melolo.DVL6vrbg.js";import{p as $}from"./chunks/theme.D5ID9m_e.js";import{W as O}from"./chunks/WatchDrama.DBITNAdz.js";const J={class:"modal-content"},U={__name:"VideoModal",props:{vid:{type:String,default:null},episodes:{type:Array,default:()=>[]},visible:{type:Boolean,default:!1}},emits:["close","update:vid"],setup(p,{emit:u}){const c=u,r=n(null),o=n(!0),s=n(null),v=n(!1);S(()=>{v.value=window.matchMedia("(hover: hover)").matches,v.value||(o.value=!0)}),T(()=>{s.value&&clearTimeout(s.value)});function m(){s.value&&(clearTimeout(s.value),s.value=null)}function e(h=2e3){v.value&&(m(),s.value=setTimeout(()=>{o.value=!1},h))}function t(){v.value&&(o.value=!0,e())}function f(){c("close")}const l=A(()=>r.value?.loading?!1:o.value);return(h,y)=>(i(),x(M,{to:"body"},[p.visible?(i(),d("div",{key:0,class:"modal-overlay",onClick:I(f,["self"]),onMousemove:t},[a("div",J,[V(a("button",{class:"close-button",onClick:f,onMouseenter:m,onMouseleave:t},"âœ•",544),[[E,l.value]]),g(O,{ref_key:"watchDramaRef",ref:r,vid:p.vid,episodes:p.episodes,"onUpdate:vid":y[0]||(y[0]=b=>h.$emit("update:vid",b))},null,8,["vid","episodes"])])],32)):N("",!0)]))}},L=C(U,[["__scopeId","data-v-1b0c5a5e"]]),W={key:0,class:"loading-state"},j={class:"skeleton-episodes"},F={class:"skeleton-episode-grid"},K={key:1,class:"error-state"},G={key:2,class:"drama-detail"},X={class:"header"},Y=["src","alt"],q={class:"info"},z={class:"abstract"},Q={class:"episode-list"},Z=["onClick"],ee="drama-detail-",ae=300*1e3,se={__name:"DramaDetail",setup(p){const u=n(!1),c=n("");B();const r=n(!0),o=n(null),s=n(null);function v(m){c.value=m,u.value=!0}return S(async()=>{const e=new URLSearchParams(window.location.search).get("id");if(!e){o.value="No drama ID provided",r.value=!1;return}const t=ee+e,f=sessionStorage.getItem(t);if(f)try{const{data:l,timestamp:h}=JSON.parse(f);if(Date.now()-h<ae){s.value=l,r.value=!1;return}}catch(l){console.warn("Cache parse error",l)}try{const l=await R(e);s.value=l.data?.video_data||{},sessionStorage.setItem(t,JSON.stringify({data:s.value,timestamp:Date.now()}))}catch(l){o.value=l.message}finally{r.value=!1}}),(m,e)=>r.value?(i(),d("div",W,[e[3]||(e[3]=H("",1)),a("div",j,[e[2]||(e[2]=a("div",{class:"skeleton-episode-title"},null,-1)),a("div",F,[(i(),d(D,null,w(6,t=>a("div",{key:t,class:"skeleton-episode"})),64))])])])):o.value?(i(),d("div",K,[e[4]||(e[4]=a("i",{class:"fas fa-exclamation-circle"},null,-1)),k(" Error: "+_(o.value),1)])):(i(),d("div",G,[a("div",X,[a("img",{src:P($)(s.value.series_cover,300),alt:s.value.series_title},null,8,Y),a("div",q,[a("h1",null,_(s.value.series_title),1),a("p",z,_(s.value.series_intro),1),a("p",null,[e[5]||(e[5]=a("strong",null,"Episodes:",-1)),k(" "+_(s.value.episode_cnt),1)]),a("p",null,[e[6]||(e[6]=a("strong",null,"Status:",-1)),k(" "+_(s.value.series_status===1?"Ongoing":"Completed"),1)])])]),e[7]||(e[7]=a("h2",null,"Episodes",-1)),a("div",Q,[(i(!0),d(D,null,w(s.value.video_list||[],t=>(i(),d("div",{key:t.vid,class:"episode",onClick:f=>v(t.vid)},[a("span",null,"Episode "+_(t.vid_index),1)],8,Z))),128))]),g(L,{vid:c.value,episodes:s.value.video_list||[],visible:u.value,onClose:e[0]||(e[0]=t=>u.value=!1),"onUpdate:vid":e[1]||(e[1]=t=>c.value=t)},null,8,["vid","episodes","visible"])]))}},te=C(se,[["__scopeId","data-v-d62f87c8"]]),re=JSON.parse('{"title":"Drama Detail","description":"","frontmatter":{"title":"Drama Detail"},"headers":[],"relativePath":"drama/index.md","filePath":"drama/index.md"}'),oe={name:"drama/index.md"},ue=Object.assign(oe,{setup(p){return(u,c)=>(i(),d("div",null,[g(te)]))}});export{re as __pageData,ue as default};
