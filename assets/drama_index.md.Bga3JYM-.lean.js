import{_ as b,p as C,s as T,o as n,b as w,c as d,j as s,aj as S,ak as x,J as g,a2 as V,e as E,al as I,y as r,C as N,am as M,G as y,H as D,a as h,t as m,k as A}from"./chunks/framework.DkZ_CT3H.js";import{g as B}from"./chunks/melolo.DVL6vrbg.js";import{p as P}from"./chunks/theme.DS-3Z2AH.js";import{W as $}from"./chunks/WatchDrama.DOYBAAhN.js";const H={class:"modal-content"},O={__name:"VideoModal",props:{vid:{type:String,default:null},episodes:{type:Array,default:()=>[]},visible:{type:Boolean,default:!1}},emits:["close","update:vid"],setup(_,{emit:v}){const c=v,i=r(!0),o=r(null),a=r(!1);C(()=>{a.value=window.matchMedia("(hover: hover)").matches,a.value||(i.value=!0)}),T(()=>{o.value&&clearTimeout(o.value)});function f(){o.value&&(clearTimeout(o.value),o.value=null)}function p(u=2e3){a.value&&(f(),o.value=setTimeout(()=>{i.value=!1},u))}function e(){a.value&&(i.value=!0,p())}function t(){c("close")}return(u,l)=>(n(),w(I,{to:"body"},[_.visible?(n(),d("div",{key:0,class:"modal-overlay",onClick:V(t,["self"]),onMousemove:e},[s("div",H,[S(s("button",{class:"close-button",onClick:t,onMouseenter:f,onMouseleave:e},"âœ•",544),[[x,i.value]]),g($,{vid:_.vid,episodes:_.episodes,"onUpdate:vid":l[0]||(l[0]=k=>u.$emit("update:vid",k))},null,8,["vid","episodes"])])],32)):E("",!0)]))}},J=b(O,[["__scopeId","data-v-0b439d6b"]]),R={key:0,class:"loading-state"},U={class:"skeleton-episodes"},j={class:"skeleton-episode-grid"},L={key:1,class:"error-state"},W={key:2,class:"drama-detail"},F={class:"header"},K=["src","alt"],G={class:"info"},X={class:"abstract"},Y={class:"episode-list"},q=["onClick"],z="drama-detail-",Q=300*1e3,Z={__name:"DramaDetail",setup(_){const v=r(!1),c=r("");N();const i=r(!0),o=r(null),a=r(null);function f(p){c.value=p,v.value=!0}return C(async()=>{const e=new URLSearchParams(window.location.search).get("id");if(!e){o.value="No drama ID provided",i.value=!1;return}const t=z+e,u=sessionStorage.getItem(t);if(u)try{const{data:l,timestamp:k}=JSON.parse(u);if(Date.now()-k<Q){a.value=l,i.value=!1;return}}catch(l){console.warn("Cache parse error",l)}try{const l=await B(e);a.value=l.data?.video_data||{},sessionStorage.setItem(t,JSON.stringify({data:a.value,timestamp:Date.now()}))}catch(l){o.value=l.message}finally{i.value=!1}}),(p,e)=>i.value?(n(),d("div",R,[e[3]||(e[3]=M("",1)),s("div",U,[e[2]||(e[2]=s("div",{class:"skeleton-episode-title"},null,-1)),s("div",j,[(n(),d(y,null,D(6,t=>s("div",{key:t,class:"skeleton-episode"})),64))])])])):o.value?(n(),d("div",L,[e[4]||(e[4]=s("i",{class:"fas fa-exclamation-circle"},null,-1)),h(" Error: "+m(o.value),1)])):(n(),d("div",W,[s("div",F,[s("img",{src:A(P)(a.value.series_cover,300),alt:a.value.series_title},null,8,K),s("div",G,[s("h1",null,m(a.value.series_title),1),s("p",X,m(a.value.series_intro),1),s("p",null,[e[5]||(e[5]=s("strong",null,"Episodes:",-1)),h(" "+m(a.value.episode_cnt),1)]),s("p",null,[e[6]||(e[6]=s("strong",null,"Status:",-1)),h(" "+m(a.value.series_status===1?"Ongoing":"Completed"),1)])])]),e[7]||(e[7]=s("h2",null,"Episodes",-1)),s("div",Y,[(n(!0),d(y,null,D(a.value.video_list||[],t=>(n(),d("div",{key:t.vid,class:"episode",onClick:u=>f(t.vid)},[s("span",null,"Episode "+m(t.vid_index),1)],8,q))),128))]),g(J,{vid:c.value,episodes:a.value.video_list||[],visible:v.value,onClose:e[0]||(e[0]=t=>v.value=!1),"onUpdate:vid":e[1]||(e[1]=t=>c.value=t)},null,8,["vid","episodes","visible"])]))}},ee=b(Z,[["__scopeId","data-v-d62f87c8"]]),ie=JSON.parse('{"title":"Drama Detail","description":"","frontmatter":{"title":"Drama Detail"},"headers":[],"relativePath":"drama/index.md","filePath":"drama/index.md"}'),se={name:"drama/index.md"},ne=Object.assign(se,{setup(_){return(v,c)=>(n(),d("div",null,[g(ee)]))}});export{ie as __pageData,ne as default};
