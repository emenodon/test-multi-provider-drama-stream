import{_ as S,p as T,s as x,o as i,b as V,c as d,j as a,ak as E,al as I,J as y,a2 as D,e as N,am as M,y as n,h as A,C as B,an as H,G as w,H as C,a as g,t as p,k as P}from"./chunks/framework.DVuO40We.js";import{g as R}from"./chunks/melolo.DVL6vrbg.js";import{p as $}from"./chunks/theme.D59Mwmx5.js";import{W as O}from"./chunks/WatchDrama.C4I_fRYh.js";const J={class:"modal-content"},U={__name:"VideoModal",props:{vid:{type:String,default:null},episodes:{type:Array,default:()=>[]},visible:{type:Boolean,default:!1}},emits:["close","update:vid"],setup(_,{emit:u}){const v=u,r=n(null),o=n(!0),t=n(null),c=n(!1);T(()=>{c.value=window.matchMedia("(hover: hover)").matches,c.value||(o.value=!0)}),x(()=>{t.value&&clearTimeout(t.value)});function m(){t.value&&(clearTimeout(t.value),t.value=null)}function e(k=2e3){c.value&&(m(),t.value=setTimeout(()=>{o.value=!1},k))}function s(){c.value&&(o.value=!0,e())}function f(){v("close")}const l=A(()=>r.value?.loading?!1:o.value);return(k,h)=>(i(),V(M,{to:"body"},[_.visible?(i(),d("div",{key:0,class:"modal-overlay",onClick:D(f,["self"]),onMousemove:s,onContextmenu:h[1]||(h[1]=D(()=>{},["prevent"]))},[a("div",J,[E(a("button",{class:"close-button",onClick:f,onMouseenter:m,onMouseleave:s},"âœ•",544),[[I,l.value]]),y(O,{ref_key:"watchDramaRef",ref:r,vid:_.vid,episodes:_.episodes,"onUpdate:vid":h[0]||(h[0]=b=>k.$emit("update:vid",b))},null,8,["vid","episodes"])])],32)):N("",!0)]))}},L=S(U,[["__scopeId","data-v-fa9161e0"]]),W={key:0,class:"loading-state"},j={class:"skeleton-episodes"},F={class:"skeleton-episode-grid"},K={key:1,class:"error-state"},G={key:2,class:"drama-detail"},X={class:"header"},Y=["src","alt"],q={class:"info"},z={class:"abstract"},Q={class:"episode-list"},Z=["onClick"],ee="drama-detail-",ae=300*1e3,te={__name:"DramaDetail",setup(_){const u=n(!1),v=n("");B();const r=n(!0),o=n(null),t=n(null);function c(m){v.value=m,u.value=!0}return T(async()=>{const e=new URLSearchParams(window.location.search).get("id");if(!e){o.value="No drama ID provided",r.value=!1;return}const s=ee+e,f=sessionStorage.getItem(s);if(f)try{const{data:l,timestamp:k}=JSON.parse(f);if(Date.now()-k<ae){t.value=l,r.value=!1;return}}catch(l){console.warn("Cache parse error",l)}try{const l=await R(e);t.value=l.data?.video_data||{},sessionStorage.setItem(s,JSON.stringify({data:t.value,timestamp:Date.now()}))}catch(l){o.value=l.message}finally{r.value=!1}}),(m,e)=>r.value?(i(),d("div",W,[e[3]||(e[3]=H('<div class="skeleton-header" data-v-d62f87c8><div class="skeleton-image" data-v-d62f87c8></div><div class="skeleton-info" data-v-d62f87c8><div class="skeleton-title" data-v-d62f87c8></div><div class="skeleton-abstract" data-v-d62f87c8></div><div class="skeleton-meta" data-v-d62f87c8></div></div></div>',1)),a("div",j,[e[2]||(e[2]=a("div",{class:"skeleton-episode-title"},null,-1)),a("div",F,[(i(),d(w,null,C(6,s=>a("div",{key:s,class:"skeleton-episode"})),64))])])])):o.value?(i(),d("div",K,[e[4]||(e[4]=a("i",{class:"fas fa-exclamation-circle"},null,-1)),g(" Error: "+p(o.value),1)])):(i(),d("div",G,[a("div",X,[a("img",{src:P($)(t.value.series_cover,300),alt:t.value.series_title},null,8,Y),a("div",q,[a("h1",null,p(t.value.series_title),1),a("p",z,p(t.value.series_intro),1),a("p",null,[e[5]||(e[5]=a("strong",null,"Episodes:",-1)),g(" "+p(t.value.episode_cnt),1)]),a("p",null,[e[6]||(e[6]=a("strong",null,"Status:",-1)),g(" "+p(t.value.series_status===1?"Ongoing":"Completed"),1)])])]),e[7]||(e[7]=a("h2",null,"Episodes",-1)),a("div",Q,[(i(!0),d(w,null,C(t.value.video_list||[],s=>(i(),d("div",{key:s.vid,class:"episode",onClick:f=>c(s.vid)},[a("span",null,"Episode "+p(s.vid_index),1)],8,Z))),128))]),y(L,{vid:v.value,episodes:t.value.video_list||[],visible:u.value,onClose:e[0]||(e[0]=s=>u.value=!1),"onUpdate:vid":e[1]||(e[1]=s=>v.value=s)},null,8,["vid","episodes","visible"])]))}},se=S(te,[["__scopeId","data-v-d62f87c8"]]),re=JSON.parse('{"title":"Drama Detail","description":"","frontmatter":{"title":"Drama Detail"},"headers":[],"relativePath":"drama/index.md","filePath":"drama/index.md"}'),oe={name:"drama/index.md"},ue=Object.assign(oe,{setup(_){return(u,v)=>(i(),d("div",null,[y(se)]))}});export{re as __pageData,ue as default};
